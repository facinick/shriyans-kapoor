# Get all staged files (Added or Modified)
STAGED_FILES=$(git diff --name-only --cached --diff-filter=AM | grep '\.ts\|\.tsx\|\.css\|\.json$')

# Debugging: Print staged files
echo "Formattable Staged files: $STAGED_FILES"

# If no relevant files are staged, skip the hook
if [ -z "$STAGED_FILES" ]; then
  echo "No relevant files to lint or format. Skipping pre-commit hook."
  exit 0
fi

# Lint and format the staged files
echo "$STAGED_FILES" | xargs pnpm biome lint --write
echo "$STAGED_FILES" | xargs pnpm biome format --write

# Re-add modified files to the staging area
echo "$STAGED_FILES" | xargs git add